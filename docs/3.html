<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="./_app/immutable/assets/_layout.9eaaa0a4.css" rel="stylesheet">
		<link href="./_app/immutable/assets/1.5aa1c98f.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.a02da088.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.3d9248da.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/singletons.dfe5e4e5.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.763d4e2c.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="./_app/immutable/entry/_layout.svelte.1362c323.js">
		<link rel="modulepreload" href="./_app/immutable/entry/_layout.js.984db11e.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/_layout.da46b06b.js">
		<link rel="modulepreload" href="./_app/immutable/entry/_path_-page.svelte.2237e4ab.js">
		<link rel="modulepreload" href="./_app/immutable/entry/_path_-page.js.53ee5f27.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/_page.6ec07485.js"><!-- HEAD_svelte-1cf3257_START --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"><style>nav {
      margin-left: 10%;
      margin-right: 10%;
    }
  </style><!-- HEAD_svelte-1cf3257_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">




<main data-theme="dark" class="container">


<article><h1>Nottify Part 3</h1>
  <p>Published: 2023-05-25</p>
  <p>Welcome to Part 3. In this part I will be talking about how I streamed audio and songs/playlists.</p>
<h3><strong>Streaming audio..</strong></h3>
<p>Now, this part was quite annoying since there was not much documentation on how to stream audio in svelte.
This is what I found out worked for me:</p>
<p>Server:</p>
<pre class="language-ts"><!-- HTML_TAG_START --><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">GET</span><span class="token operator">:</span> <span class="token function-variable function">RequestHandler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>cookies<span class="token punctuation">,</span> url<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> stream <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">song.mp3</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Basic client:</p>
<pre class="language-svelte"><!-- HTML_TAG_START --><code class="language-svelte"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> audio <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Audio</span><span class="token punctuation">(</span><span class="token string">'/audio/1'</span><span class="token punctuation">)</span>
    audio<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// you have to put play in a user input event like a button click otherwise your browser will block playing the audio.</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre>
<p>Once I had audio streaming I was able to start designing the website. I made all my components for songs modular by making them into components.</p>
<div class="ImageDiv svelte-1tuin5d"><b>This is the design I came up with for each song object.</b>
    <b>It has play/pause, song name, uploader name and a button list</b>
    <b>where you can choose options such as like remove from playlist.</b>
    <img src="SongExample.PNG" class="svelte-1tuin5d">
    <b>This is how it looked when I put it into a list:</b></div>
<div class="ImageDiv svelte-1tuin5d">
    <img src="SongsList.PNG" class="svelte-1tuin5d"></div>
<br>
<p>I built it quite modular which is why I was able to place the song list in any page I wanted, I placed it in a playlist page here:</p>
<div class="ImageDiv svelte-1tuin5d"><img src="SongsListPlaylist.PNG" class="svelte-1tuin5d"></div>
<h3><strong>Conclusion</strong></h3>
<p>Now, I think this went pretty smoothly though I have to say it was quite annoying finding anything about audio streaming. I’m happy with how turned out.</p>
<h3><strong>Progress</strong></h3>
<p>✔️ Register / login functionallity <br>
✔️ Register / login page <br>
✔️ Typescript <br>
✔️ Audio streaming <br>
✔️ Song lists <br></p></article>
</main>


			
			<script>
				{
					__sveltekit_2zrq7z = {
						base: new URL(".", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("./_app/immutable/entry/start.a02da088.js"),
						import("./_app/immutable/entry/app.763d4e2c.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
